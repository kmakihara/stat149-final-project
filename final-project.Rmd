---
title: 'STAT 149: Final Project'
author: "Kazuma Makihara and Bobby Byung-Hoon Min"
date: "4/17/2018"
output: pdf_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE, echo=FALSE}
#### Set up process here ####
#install.packages("faraway")
#install.packages("nnet")

#install.packages("car")
#install.packages("kyotil")
#install.packages("arm")


```

```{r include=FALSE}
#### Include R Scripts without including in the markdown ####
na.convert.mean = function (frame) 
{
    vars <- names(frame)
    if (!is.null(resp <- attr(attr(frame, "terms"), "response"))) {
        vars <- vars[-resp]
        x <- frame[[resp]]
        pos <- is.na(x)
        if (any(pos)) {
            frame <- frame[!pos, , drop = FALSE]
            warning(paste(sum(pos), "observations omitted due to missing values in the response"))
        }
    }
    for (j in vars) {  #j is variable names
        x <- frame[[j]]
        pos <- is.na(x)
        if (any(pos)) {
            if (length(levels(x))) {   # factors
                xx <- as.character(x)
                xx[pos] <- "NA"
                x <- factor(xx, exclude = NULL)
            }
            else if (is.matrix(x)) {   # matrices
                ats <- attributes(x)
                x.na <- 1*pos
#               x[pos] <- 0
                w <- !pos
                n <- nrow(x)
                TT <- array(1, c(1, n))
                xbar <- (TT %*% x)/(TT %*% w)
                xbar <- t(TT) %*% xbar
                x[pos] <- xbar[pos]
                attributes(x) <- ats
                attributes(x.na) <- ats
                dimnames(x.na)[[2]]=paste(dimnames(x)[[2]],".na",sep='')
                frame[[paste(j,".na",sep='')]] <- x.na 
            } else {   # ordinary numerical vector
                ats <- attributes(x)
                x[pos] <- mean(x[!pos])
#               x[pos] <- 0
                x.na <- 1*pos
                frame[[paste(j,".na",sep='')]] <- x.na 
                attributes(x) <- ats
            }
            frame[[j]] <- x
        }
    }
    frame
}
```

## Title
### Sub-Title
Write-up paragraphs and \alpha sign and shit.
```{r, out.width = "500px"}
#### Images are included by doing this #####
knitr::include_graphics("./pset4_q1.jpg")
```

## Introduction and Setup
```{r}
#library(brglm)
#library(aod)
#library(faraway)
#library(nnet)
#library(arm)
install.packages("Metrics")
library(Metrics)
train <- read.csv("./Data/train.csv")
test <- read.csv("./Data/test.csv")
```
## Explantory Data Analysis (EDA)
### Predictior Variables
Analysis on each predictors to come later
### Summary Statistics and Null Model
Run summary statistics on the train data and, then, fit the full dataset with all predictors to a basic glm model.
Conclusions:
1. get rid of one of 'density_rural', 'density_suburban', or 'density_urban' -> sums to 1
2. Change education to ordinal layers and not categorical values? OR change base-line to "no hs degree"
```{r}
summary(train)
head(train)
train$suppdem = as.numeric(train$suppdem) - 1
# Missing Value Mean Imputer
train.na = na.convert.mean(train)
full <- glm(suppdem ~ ., family = binomial, data = train.na)
summary(full)
preds = predict(full, data=train.na, type="response")
logLoss(train.na$suppdem, preds)
```

## Model Selection

### Testing
### Step-wise Deviance
### Fitting various models
### Data Imputer


## Predictions
### Results and Conclusions
### Log-loss 